<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product CRUD</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    body {
      background: #f5f7fa;
      padding: 40px;
      font-family: "Poppins", sans-serif;
    }

    .card {
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="row justify-content-center">

      <!-- FORM -->
      <div class="col-md-5">
        <div class="card p-4">
          <h4 class="text-center mb-3">Add Product</h4>

          <form id="productForm">
            <div class="mb-3">
              <label class="form-label">Product Name</label>
              <input type="text" id="name" class="form-control" required />
            </div>

            <div class="mb-3">
              <label class="form-label">Price</label>
              <input type="number" id="price" class="form-control" required />
            </div>

            <div class="mb-3">
              <label class="form-label">Quantity</label>
              <input type="number" id="qty" class="form-control" required />
            </div>

            <button class="btn btn-primary w-100">Add Product</button>
          </form>
        </div>
      </div>

      <!-- TABLE -->
      <div class="col-md-7 mt-md-0 mt-4">
        <div class="card p-4">
          <h4 class="text-center mb-3">Product List</h4>

          <table class="table table-bordered text-center">
            <thead class="table-dark">
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Price</th>
                <th>Qty</th>
                <th>Total</th>
                <th colspan="2">Action</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div>

    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // ðŸ”¹ yahin pe dalna hai
      if (!localStorage.getItem("product")) {
        localStorage.setItem("product", JSON.stringify([]));
      }
      const productForm = document.getElementById("productForm");
      const tbody = document.getElementById("tbody");
      productForm.addEventListener("submit", (e) => {
        e.preventDefault();
        let name = document.getElementById("name").value;
        let price = Number(document.getElementById("price").value);
        let qty = Number(document.getElementById("qty").value);
        let total = price * qty;
        const obj = { name, price, qty, total };
        let products = JSON.parse(localStorage.getItem("product"));
        products.push(obj);
        localStorage.setItem("product", JSON.stringify(products));
        productForm.reset();
        renderTable();
      });

      // DELETE PRODUCT (Event Delegation)
      tbody.addEventListener("click", (e) => {
        // if (e.target.classList.contains("delete")) {
        let index = e.target.getAttribute("data-index"); 

        let products = JSON.parse(localStorage.getItem("product"));
      let sp =   products.splice(index, 1);
  //  console.log(sp,"sp");
   
        localStorage.setItem("product", JSON.stringify(products));
        renderTable();
        
      });

      // RENDER TABLE
      const renderTable = () => {
        let products = JSON.parse(localStorage.getItem("product")) ;
        tbody.innerHTML = "";
        products.forEach((item, index) => {
          tbody.innerHTML += `
            <tr>
              <td>${index + 1}</td>
              <td>${item.name}</td>
              <td>${item.price}</td>
              <td>${item.qty}</td>
              <td>${item.total}</td>
              <td>
                <button class="btn btn-success edit" data-index="${index}">
                  Edit
                </button>
                <button class="btn btn-danger delete" data-index="${index}">
                  Delete
                </button>
              </td>
            </tr>
          `;
        });
      }
      // SHOW DATA ON PAGE LOAD
      renderTable();
    });
  </script>
</body>

</html>